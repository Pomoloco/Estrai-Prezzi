<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>EstrAI Prezzi — (Descrizione | Prezzo | IVA)</title>
  <link rel="stylesheet" href="styles.css"/>
  <!-- PDF.js (nomodule) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.min.js"></script>
  <script>pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.worker.min.js";</script>
  <!-- Tesseract.js v2 (Safari-friendly) -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js"></script>
</head>
<body>
<header>
  <h1>EstrAI Prezzi</h1>
  <p class="sub">OCR client-side (Tesseract.js 2.x) • PDF multipagina • Parser fornitori • Safari iOS OK</p>
</header>

<section class="controls">
  <div class="row">
    <input id="file" type="file" accept="image/*,application/pdf" multiple>
    <button id="pick" class="btn primary">Carica file…</button>
    <button id="demo" class="btn">Usa demo</button>
    <button id="cancel" class="btn">Annulla</button>
    <button id="csv" class="btn">Esporta CSV</button>
  </div>
  <div class="row">
    <label>Modello OCR:
      <select id="model">
        <option value="best" selected>tessdata_best (accurato)</option>
        <option value="fast">tessdata_fast (veloce)</option>
      </select>
    </label>
    <label>PSM:
      <select id="psm">
        <option value="4" selected>4 (colonne)</option>
        <option value="6">6 (righe/colonne)</option>
        <option value="3">3 (default)</option>
      </select>
    </label>
    <label><input type="checkbox" id="numericPass" checked> Secondo pass numerico (stabilizza Prezzi/IVA)</label>
  </div>
  <div id="status">Pronto.</div>
  <progress id="bar" max="100" value="0"></progress>
</section>

<section class="split">
  <div class="pane">
    <h3>Risultati (Descrizione | Prezzo | IVA)</h3>
    <table id="tbl">
      <thead><tr><th>#</th><th>Descrizione</th><th>Prezzo (€)</th><th>IVA (%)</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
  <div class="pane">
    <details open>
      <summary>Testo OCR grezzo</summary>
      <textarea id="raw" spellcheck="false"></textarea>
    </details>
    <details open>
      <summary>Log</summary>
      <pre id="log"></pre>
    </details>
  </div>
</section>

<footer>
  <small>Build C-default • Nessun server esterno. Se trovi errori, copia le ultime 10 righe del Log.</small>
</footer>

<script src="parser.js"></script>
<script src="app.js"></script>
</body>
</html>
<!-- test -->
